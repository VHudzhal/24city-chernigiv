<?php
$tags = [
    [
        'label' => 'ВСЕ ДЛЯ ДЕТЕЙ',
        'subs'  => [
            [
                'label' => 'Детская одежда',
                'subs' => [
                    'Одежда для мальчиков',
                    'Одежда для девочек',
                    'Одежда для новорожденных'
                ]
            ],
            [ 'label' => 'Детская обувь' ],
            [ 'label' => 'Детские коляски' ],
            [ 'label' => 'Детские автокресла' ],
            [ 'label' => 'Детская мебель' ],
            [ 'label' => 'Игрушки' ],
            [ 'label' => 'Детский транспорт' ],
            [ 'label' => 'Товары для кормления' ],
            [ 'label' => 'Товары для школьников' ],
            [ 'label' => 'Прочие детские товары' ],
        ]
    ],

    [
        'label' => 'НЕДВИЖИМОСТЬ',
        'subs'  => [
            [
                'label' => 'Квартиры',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'комнаты',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Дома',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Земля',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Коммерческая недвижимость',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Гаражи',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'парковки',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Посуточная аренда жилья',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Предложения от застройщиков',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],
            [
                'label' => 'Недвижимость за рубежом',
                'subs'  => [ 'сдам','продам', 'куплю', 'меняю' ]
            ],

        ],
    ],

    [
        'label' => 'АВТОТРАНСПОРТ',
        'subs'  => [
            [
                'label' => 'Легковые автомобили',
                'subs'  => [
                    'Acura',
                    'Alfa Romeo',
                    'Audi',
                    'Bentley',
                    'BMW',
                    'Brilliance',
                    'BYD',
                    'Cadillac',
                    'Chana',
                    'ChangFeng',
                    'Chery',
                    'Chevrolet',
                    'Chrysler',
                    'Citroen',
                    'Dacia',
                    'Dadi',
                    'Daewoo',
                    'Daihatsu',
                    'Dodge',
                    'Ferrari',
                    'Fiat',
                    'Ford',
                    'Geely',
                    'GMC',
                    'Great Wall',
                    'Honda',
                    'Hummer',
                    'Hyundai',
                    'Infinity',
                    'Isuzu',
                    'Iveco',
                    'JAC',
                    'Jaguar',
                    'Jeep',
                    'Kia',
                    'Lancia',
                    'Land Rower',
                    'Lexus',
                    'Lifan',
                    'Lincoln',
                    'Maserati',
                    'Mazda',
                    'Mercedes-Benz',
                    'MG',
                    'MINI',
                    'Mitsubishi',
                    'Nissan',
                    'Oldsmobile',
                    'Opel',
                    'Peugeot',
                    'Pontiac',
                    'Porsche',
                    'Ravon',
                    'Renault',
                    'Roewe',
                    'Rover',
                    'Saab',
                    'Samand',
                    'Seat',
                    'Skoda',
                    'Smart',
                    'SsangYong',
                    'Subaru',
                    'Suzuki',
                    'Tesla',
                    'Toyota',
                    'Volkswagen',
                    'Volvo',
                    'Wartburg',
                    'ZX',
                    'Богдан',
                    'ВАЗ',
                    'ГАЗ',
                    'ЗАЗ',
                    'ИЖ',
                    'ЛуАЗ',
                    'Москвич / АЗЛК',
                    'РАФ',
                    'УАЗ',
                    'Другие'
                ]
            ],
            [ 'label' => 'Грузовые автомобили' ],
            [ 'label' => 'Автобусы' ],
            [
                'label' => 'Мото',
                'subs'  => [
                    'Мопеды / скутеры',
                    'Квадроциклы',
                    'Мотоциклы',
                    'Мото - прочее'
                ]
            ],
            [
                'label' => 'Спецтехника',
                'subs'  => [
                    'Бульдозеры / тракторы',
                    'Коммунальная техника',
                    'Погрузчики',
                    'Самосвалы',
                    'Строительная техника',
                    'Экскаваторы',
                    'Оборудование для спецтехники',
                    'Прочая спецтехника'
                ]
            ],
            [ 'label' => 'Сельхозтехника' ],
            [ 'label' => 'Водный транспорт' ],
            [ 'label' => 'Воздушный транспорт' ],
            [ 'label' => 'Прицепы / дома на колесах' ],
            [ 'label' => 'Другой транспорт' ],
            [
                'label' => 'Запчасти для транспорта ',
                'subs'  => [
                    'Автозапчасти и аксессуары',
                    'Шины, диски и колёса',
                    'Запчасти для спец / с.х. техники',
                    'Мотозапчасти и аксессуары',
                    'Прочие запчасти'
                ]
            ]
        ]
    ],

    [ 'label' => 'Работа' ],

    [ 'label' => 'Животные' ],

    [ 'label' => 'Дом и Сад' ],

    [ 'label' => 'Электроника' ],

    [ 'label' => 'Бизнес и услуги' ],

    [ 'label' => 'Мода и стиль' ],

    [ 'label' => 'Хобби отдых и спорт' ]
];

add_action('init', 'bizoc_ads_cpt');
function bizoc_ads_cpt()
{
	$cpt =  [
		'ads' => __('Обьявления'),
		'company_news' => __('Новости')
	];
	
	foreach($cpt as $key=>$value){
    register_post_type($key, array(
        'labels'             => array(
            'name'               => $value,
          ),
        'public'             => true,
        'publicly_queryable' => true,
        'show_ui'            => true,
        'supports'           => array('title','editor','author','thumbnail','excerpt','trackbar','custom-fields','revisions','page-attributes','post-formats')
    ));}
}

function bizov_ads_html($company_id,$ads_id = 0)
{//echo $company_id;echo $ads_id;
	global $tags;
	$post = get_post($ads_id);
	
    bizov_main_block(array(
        'title' => $ads_id ? $post->post_title :  '',
        'content' => $ads_id ? $post->post_content : ''
    ));

    bizov_input(array(
        'label' => __('тема объявления '),
        'id'    => 'type',
        'metaoptions'=> [ 'сдам','продам', 'куплю', 'меняю' ],
        'value' => get_post_meta($ads_id,'type',1),
        'required' => 0,
        'type' => 'select'
    ));

    bizov_input(array(
        'label'     => __('Thumbnail', 'bizov'),
        'id'        => 'thumb',
        'type'      => 'image',
		'value' => maybe_unserialize(get_post_meta($ads_id,'thumb',1)),
        'multiple'  => 0,
        'required'  => 0
    ));

$tagsx = maybe_unserialize(get_post_meta($ads_id,'tag',1));//print_r($tagsx);
?>
    <label for=""><?php echo esc_html__('Выбор рубрики'); ?></label>
        <div id="adsTags"><?php if(isset($tagsx[0])){ ?>
			<select name="tag[]">
	<?php foreach($tags as $key=>$value){ ?>
		<option value="<?php echo $key; ?>" <?php selected($key,$tagsx[0]); ?>><?php echo $value['label']; ?></option>
	<?php } ?>
			</select>
<?php } ?></div>
        <div id="adsTags1"><?php if(isset($tagsx[1])){ ?>
			<select name="tag[]">
	<?php foreach($tags[$tagsx[0]]['subs'] as $key=>$value){ ?>
		<option value="<?php echo $key; ?>" <?php selected($key,$tagsx[1]); ?>><?php echo $value['label']; ?></option>
	<?php } ?>
			</select>
<?php } ?></div>
        <div id="adsTags2"><?php if(isset($tagsx[2])){ ?>
			<select name="tag[]">
	<?php foreach($tags[$tagsx[0]]['subs'][$tagsx[1]]['subs'] as $key=>$value){ ?>
		<option value="<?php echo $key; ?>" <?php selected($key,$tagsx[2]); ?>><?php echo $value; ?></option>
	<?php } ?>
			</select>
<?php } ?></div>
    <?php
	$callback = maybe_unserialize(get_post_meta($ads_id,'callback',1));//print_r($callback);
    $phones = get_post_meta($company_id, 'phones', 1);
    $emails = get_post_meta($company_id, 'emails_group', 1);
    $socials = get_post_meta($company_id, 'socials', 1); ?>
<label for=""><?php echo __('Callback form', 'bizov'); ?></label>
<ul>
<?php
    foreach (maybe_unserialize($phones) as $key => $value) { ?>
        <li>
            <label for="">
                <input type="checkbox" name="callback[]" class="callback" value="<?php echo $value['number']; ?>" <?php checked(in_array($value['number'],$callback)); ?>>
                <?php echo $value['number']; ?>
            </label>
        </li>
    <?php }
    foreach (maybe_unserialize($emails) as $key => $value) { ?>
            <li>
                <label for="">
                    <input type="checkbox" name="callback[]" class="callback" value="<?php echo $value['email']; ?>" <?php checked(in_array($value['email'],$callback)); ?>>
                    <?php echo $value['email']; ?>
                </label>
            </li>
        <?php }
    foreach (maybe_unserialize($socials) as $key => $value) { ?>
                <li>
                    <label for="">
                        <input type="checkbox" name="callback[]" class="callback" value="<?php echo $value['link']; ?>" <?php checked(in_array($value['link'],$callback)); ?>>
                        <?php echo $value['link']; ?>
                    </label>
                </li>
            <?php }
    echo '</ul>';
    $date = maybe_unserialize(get_post_meta($ads_id,'date',1));?>

    <p>
        <?php esc_html_e('Start Day'); ?>:
        <input type="text" name="date[]" value="<?php if(isset($date[0])) echo $date[0]; ?>" id="dateStart">
    </p>
    <p>
        <?php esc_html_e('Start Day'); ?>:
        <input type="text" name="date[]" value="<?php if(isset($date[1])) echo $date[1]; ?>" id="dateEnd">
    </p>
<?php
}
